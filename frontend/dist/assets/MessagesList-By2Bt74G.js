import{r,j as e,ax as q,ay as B,az as T,aA as G,aB as H,aC as I,aD as J,aE as K,aF as Q}from"./index-CBHbDdlb.js";const X=()=>{const[o,g]=r.useState([]),[v,w]=r.useState([]),[A,x]=r.useState(!0),[C,D]=r.useState(null),[n,S]=r.useState(1),[f]=r.useState(10),[i,M]=r.useState(null),[m,$]=r.useState(""),[h,O]=r.useState("all"),[l,k]=r.useState(null),[c,F]=r.useState(null),[E,R]=r.useState(!1),[L,u]=r.useState(null),b="http://localhost:8000/api";r.useEffect(()=>{(async()=>{try{x(!0);const t=await fetch(`${b}/contact-messages/`);if(!t.ok)throw new Error("Failed to fetch messages");const a=await t.json();g(a),w(a)}catch(t){D(t.message)}finally{x(!1)}})()},[b]),r.useEffect(()=>{let s=o;if(h==="read"?s=s.filter(t=>t.is_read):h==="unread"&&(s=s.filter(t=>!t.is_read)),m){const t=m.toLowerCase();s=s.filter(a=>a.name.toLowerCase().includes(t)||a.email.toLowerCase().includes(t)||a.phone&&a.phone.includes(t)||a.subject&&a.subject.toLowerCase().includes(t))||msg.message.toLowerCase().includes(t)}l&&c?s=s.filter(t=>{const a=new Date(t.created_at);return a>=l&&a<=c}):l?s=s.filter(t=>new Date(t.created_at)>=l):c&&(s=s.filter(t=>new Date(t.created_at)<=c)),w(s),S(1)},[o,h,m,l,c]);const j=v.length,d=Math.ceil(j/f),p=n*f,_=p-f,P=v.slice(_,p),y=s=>{s>0&&s<=d&&S(s)},z=s=>{M(s),s.is_read||g(o.map(t=>t.id===s.id?{...t,is_read:!0}:t))},N=()=>{M(null)},U=async s=>{try{if(x(!0),!(await fetch(`${b}/contact-messages/${s}/`,{method:"DELETE"})).ok)throw new Error("Failed to delete message");g(o.filter(a=>a.id!==s)),u(null)}catch(t){D(t.message)}finally{x(!1)}},V=()=>{k(null),F(null)};return A?e.jsx("div",{className:"flex justify-center items-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-[#7bbf42]"})}):C?e.jsxs("div",{className:"text-center py-12 text-red-500",children:["Error: ",C]}):e.jsxs("div",{className:"p-4 md:p-6 bg-white rounded-lg shadow-md max-w-6xl mx-auto",children:[e.jsx("h2",{className:"text-2xl md:text-3xl font-bold text-gray-800 mb-6 text-center",children:"Contact Messages"}),e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center mb-6 gap-4",children:[e.jsxs("div",{className:"relative w-full md:w-64",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(q,{className:"text-gray-400"})}),e.jsx("input",{type:"text",placeholder:"Search messages...",className:"pl-10 pr-4 py-2 w-full border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#7bbf42] focus:border-[#7bbf42] outline-none transition",value:m,onChange:s=>$(s.target.value)})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:"text-gray-600",children:"Filter:"}),e.jsxs("select",{className:"border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-[#7bbf42] focus:border-[#7bbf42] outline-none transition",value:h,onChange:s=>O(s.target.value),children:[e.jsx("option",{value:"all",children:"All Messages"}),e.jsx("option",{value:"unread",children:"Unread Only"}),e.jsx("option",{value:"read",children:"Read Only"})]})]}),e.jsxs("button",{onClick:()=>R(!E),className:"flex items-center space-x-1 px-3 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 transition",children:[e.jsx(B,{className:"text-gray-600"}),e.jsx("span",{children:"Date Filter"})]})]})]}),E&&e.jsxs("div",{className:"mb-6 p-4 border border-gray-200 rounded-lg bg-gray-50",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"From Date"}),e.jsx(T,{selected:l,onChange:s=>k(s),selectsStart:!0,startDate:l,endDate:c,className:"border border-gray-300 rounded-lg px-3 py-2 w-full focus:ring-2 focus:ring-[#7bbf42] focus:border-[#7bbf42] outline-none transition",placeholderText:"Select start date"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"To Date"}),e.jsx(T,{selected:c,onChange:s=>F(s),selectsEnd:!0,startDate:l,endDate:c,minDate:l,className:"border border-gray-300 rounded-lg px-3 py-2 w-full focus:ring-2 focus:ring-[#7bbf42] focus:border-[#7bbf42] outline-none transition",placeholderText:"Select end date"})]})]}),(l||c)&&e.jsx("div",{className:"mt-3 flex justify-end",children:e.jsx("button",{onClick:V,className:"px-3 py-1 text-sm text-red-500 hover:text-red-700",children:"Clear Date Filter"})})]}),e.jsx("div",{className:"overflow-x-auto rounded-lg border border-gray-200 shadow-sm",children:e.jsxs("table",{className:"min-w-full bg-white",children:[e.jsx("thead",{className:"bg-gradient-to-r from-[#7bbf42] to-[#f9b414] text-white",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium",children:"Status"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium",children:"Name"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium",children:"Subject"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium",children:"Date"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200",children:P.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:"5",className:"px-6 py-4 text-center text-gray-500",children:"No messages found matching your criteria."})}):P.map(s=>e.jsxs("tr",{className:`hover:bg-gray-50 transition duration-150 ease-in-out ${s.is_read?"":"bg-blue-50"}`,children:[e.jsx("td",{className:"px-4 py-3 whitespace-nowrap",children:e.jsx("span",{className:`inline-block w-3 h-3 rounded-full ${s.is_read?"bg-gray-400":"bg-blue-500"}`})}),e.jsx("td",{className:"px-4 py-3 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0 h-10 w-10 bg-[#7bbf42] rounded-full flex items-center justify-center text-white font-bold",children:s.name.charAt(0)}),e.jsxs("div",{className:"ml-4",children:[e.jsx("div",{className:"text-sm font-medium text-gray-900",children:s.name}),e.jsx("div",{className:"text-sm text-gray-500",children:s.email})]})]})}),e.jsxs("td",{className:"px-4 py-3",children:[e.jsx("div",{className:"text-sm text-gray-900 font-medium",children:s.subject||"No subject"}),e.jsx("div",{className:"text-sm text-gray-500 truncate max-w-xs",children:s.message})]}),e.jsxs("td",{className:"px-4 py-3 whitespace-nowrap",children:[e.jsx("div",{className:"text-sm text-gray-500",children:new Date(s.created_at).toLocaleDateString()}),e.jsx("div",{className:"text-xs text-gray-400",children:new Date(s.created_at).toLocaleTimeString()})]}),e.jsxs("td",{className:"px-4 py-3 whitespace-nowrap text-right text-sm font-medium space-x-2",children:[e.jsx("button",{onClick:()=>z(s),className:"text-[#7bbf42] hover:text-[#6aa638] font-medium",children:"View"}),e.jsx("button",{onClick:()=>u(s.id),className:"text-red-500 hover:text-red-700 font-medium",children:"Delete"})]})]},s.id))})]})}),d>1&&e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-center mt-6 gap-4",children:[e.jsxs("div",{className:"text-sm text-gray-600",children:["Showing ",_+1," to ",Math.min(p,j)," of ",j," messages"]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs("button",{className:"px-3 py-1 border border-gray-300 rounded-lg hover:bg-gray-50 transition flex items-center disabled:opacity-50",onClick:()=>y(n-1),disabled:n===1,children:[e.jsx(G,{className:"mr-1"})," Previous"]}),e.jsx("div",{className:"flex space-x-1",children:Array.from({length:Math.min(5,d)},(s,t)=>{let a;return d<=5||n<=3?a=t+1:n>=d-2?a=d-4+t:a=n-2+t,e.jsx("button",{className:`px-3 py-1 rounded-lg ${n===a?"bg-[#7bbf42] text-white":"border border-gray-300 hover:bg-gray-50"} transition`,onClick:()=>y(a),children:a},a)})}),e.jsxs("button",{className:"px-3 py-1 border border-gray-300 rounded-lg hover:bg-gray-50 transition flex items-center disabled:opacity-50",onClick:()=>y(n+1),disabled:n===d,children:["Next ",e.jsx(H,{className:"ml-1"})]})]})]}),i&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsx("div",{className:"bg-white rounded-lg shadow-xl max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex justify-between items-start mb-4",children:[e.jsx("h3",{className:"text-xl font-bold text-gray-800",children:"Message Details"}),e.jsx("button",{onClick:N,className:"text-gray-500 hover:text-gray-700",children:"âœ•"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0 h-12 w-12 bg-[#7bbf42] rounded-full flex items-center justify-center text-white font-bold text-xl",children:i.name.charAt(0)}),e.jsxs("div",{className:"ml-4",children:[e.jsx("h4",{className:"text-lg font-bold text-gray-900",children:i.name}),e.jsx("p",{className:"text-gray-600",children:i.email})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"bg-gray-50 p-3 rounded-lg",children:[e.jsxs("div",{className:"flex items-center text-gray-600 mb-1",children:[e.jsx(I,{className:"mr-2"}),e.jsx("span",{children:"Phone"})]}),e.jsx("p",{className:"text-gray-900",children:i.phone||"Not provided"})]}),e.jsxs("div",{className:"bg-gray-50 p-3 rounded-lg",children:[e.jsxs("div",{className:"flex items-center text-gray-600 mb-1",children:[e.jsx(J,{className:"mr-2"}),e.jsx("span",{children:"Received"})]}),e.jsx("p",{className:"text-gray-900",children:new Date(i.created_at).toLocaleString()})]})]}),e.jsxs("div",{className:"bg-gray-50 p-3 rounded-lg",children:[e.jsxs("div",{className:"flex items-center text-gray-600 mb-1",children:[e.jsx(K,{className:"mr-2"}),e.jsx("span",{children:"Subject"})]}),e.jsx("p",{className:"text-gray-900 font-medium",children:i.subject||"No subject"})]}),e.jsxs("div",{className:"bg-gray-50 p-3 rounded-lg",children:[e.jsxs("div",{className:"flex items-center text-gray-600 mb-1",children:[e.jsx(Q,{className:"mr-2"}),e.jsx("span",{children:"Message"})]}),e.jsx("p",{className:"text-gray-900 whitespace-pre-line",children:i.message})]})]}),e.jsxs("div",{className:"mt-6 flex justify-between",children:[e.jsx("button",{onClick:()=>{u(i.id),N()},className:"px-4 py-2 bg-red-500 text-white rounded-lg hover:bg-red-600 transition",children:"Delete Message"}),e.jsx("button",{onClick:N,className:"px-4 py-2 bg-[#7bbf42] text-white rounded-lg hover:bg-[#6aa638] transition",children:"Close"})]})]})})}),L&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-md w-full p-6",children:[e.jsx("h3",{className:"text-xl font-bold text-gray-800 mb-4",children:"Confirm Deletion"}),e.jsx("p",{className:"text-gray-600 mb-6",children:"Are you sure you want to delete this message? This action cannot be undone."}),e.jsxs("div",{className:"flex justify-end space-x-3",children:[e.jsx("button",{onClick:()=>u(null),className:"px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 transition",children:"Cancel"}),e.jsx("button",{onClick:()=>U(L),className:"px-4 py-2 bg-red-500 text-white rounded-lg hover:bg-red-600 transition",children:"Delete"})]})]})})]})};export{X as default};
//# sourceMappingURL=MessagesList-By2Bt74G.js.map
